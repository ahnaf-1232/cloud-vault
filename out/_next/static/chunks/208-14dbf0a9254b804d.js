"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[208],{918:function(e,t,a){a.d(t,{w:function(){return g}});var r=a(7437),n=a(7461),s=a(2869),o=a(4190),i=a(2265),l=a(4930),d=a(4508);let c=i.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(l.fC,{ref:t,className:(0,d.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...n})});c.displayName=l.fC.displayName,i.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(l.Ee,{ref:t,className:(0,d.cn)("aspect-square h-full w-full",a),...n})}).displayName=l.Ee.displayName;let u=i.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(l.NY,{ref:t,className:(0,d.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...n})});u.displayName=l.NY.displayName;var f=a(1341),m=a(8728),h=a(7692),p=a(7648),x=a(9376);function g(){var e;let{user:t,logout:a}=(0,n.a)(),i=(0,x.useRouter)();return(0,r.jsx)("nav",{className:"border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,r.jsxs)("div",{className:"container flex h-16 items-center justify-between",children:[(0,r.jsxs)(p.default,{href:"/dashboard",className:"flex items-center space-x-2",children:[(0,r.jsx)(f.Z,{className:"h-6 w-6"}),(0,r.jsx)("span",{className:"font-bold text-xl",children:"CloudVault"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("nav",{className:"hidden md:flex items-center space-x-6",children:[(null==t?void 0:t.role)!=="admin"&&(0,r.jsx)(p.default,{href:"/dashboard",className:"text-sm font-medium hover:text-primary",children:"Dashboard"}),(null==t?void 0:t.role)!=="admin"&&(0,r.jsx)(p.default,{href:"/files",className:"text-sm font-medium hover:text-primary",children:"My Files"}),(null==t?void 0:t.role)!=="admin"&&(0,r.jsx)(p.default,{href:"/search",className:"text-sm font-medium hover:text-primary",children:"Search"})]}),(0,r.jsxs)(o.h_,{children:[(0,r.jsx)(o.$F,{asChild:!0,children:(0,r.jsx)(s.z,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:(0,r.jsx)(c,{className:"h-8 w-8",children:(0,r.jsx)(u,{children:(null==t?void 0:null===(e=t.name)||void 0===e?void 0:e.charAt(0).toUpperCase())||"U"})})})}),(0,r.jsxs)(o.AW,{className:"w-56",align:"end",forceMount:!0,children:[(0,r.jsx)("div",{className:"flex items-center justify-start gap-2 p-2",children:(0,r.jsxs)("div",{className:"flex flex-col space-y-1 leading-none",children:[(0,r.jsx)("p",{className:"font-medium",children:null==t?void 0:t.name}),(0,r.jsx)("p",{className:"w-[200px] truncate text-sm text-muted-foreground",children:null==t?void 0:t.email})]})}),(0,r.jsx)(o.VD,{}),(0,r.jsx)(o.Xi,{asChild:!0,children:(0,r.jsxs)(p.default,{href:"/settings",children:[(0,r.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"Settings"]})}),(0,r.jsx)(o.VD,{}),(0,r.jsxs)(o.Xi,{onClick:()=>{a(),i.push("/")},children:[(0,r.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),"Log out"]})]})]})]})]})})}},5476:function(e,t,a){a.d(t,{i:function(){return l}});var r=a(7437),n=a(7461),s=a(9376),o=a(2265),i=a(1817);function l(e){let{children:t,adminOnly:a=!1}=e,{user:l,loading:d}=(0,n.a)(),c=(0,s.useRouter)();return((0,o.useEffect)(()=>{!d&&(l?a&&"admin"!==l.role&&c.push("/dashboard"):c.push("/login"))},[l,d,c,a]),d)?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)(i.Z,{className:"h-8 w-8 animate-spin"})}):!l||a&&"admin"!==l.role?null:(0,r.jsx)(r.Fragment,{children:t})}},2869:function(e,t,a){a.d(t,{d:function(){return l},z:function(){return d}});var r=a(7437),n=a(2265),s=a(7053),o=a(535),i=a(4508);let l=(0,o.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:a,variant:n,size:o,asChild:d=!1,...c}=e,u=d?s.g7:"button";return(0,r.jsx)(u,{className:(0,i.cn)(l({variant:n,size:o,className:a})),ref:t,...c})});d.displayName="Button"},6070:function(e,t,a){a.d(t,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return o},aY:function(){return c},ll:function(){return l}});var r=a(7437),n=a(2265),s=a(4508);let o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...n})});o.displayName="Card";let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",a),...n})});i.displayName="CardHeader";let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",a),...n})});l.displayName="CardTitle";let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",a),...n})});d.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",a),...n})});c.displayName="CardContent",n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",a),...n})}).displayName="CardFooter"},4190:function(e,t,a){a.d(t,{$F:function(){return u},AW:function(){return f},VD:function(){return h},Xi:function(){return m},h_:function(){return c}});var r=a(7437),n=a(2265),s=a(765),o=a(407),i=a(401),l=a(519),d=a(4508);let c=s.fC,u=s.xz;s.ZA,s.Uv,s.Tr,s.Ee,n.forwardRef((e,t)=>{let{className:a,inset:n,children:i,...l}=e;return(0,r.jsxs)(s.fF,{ref:t,className:(0,d.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",a),...l,children:[i,(0,r.jsx)(o.Z,{className:"ml-auto"})]})}).displayName=s.fF.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.tu,{ref:t,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})}).displayName=s.tu.displayName;let f=n.forwardRef((e,t)=>{let{className:a,sideOffset:n=4,...o}=e;return(0,r.jsx)(s.Uv,{children:(0,r.jsx)(s.VY,{ref:t,sideOffset:n,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...o})})});f.displayName=s.VY.displayName;let m=n.forwardRef((e,t)=>{let{className:a,inset:n,...o}=e;return(0,r.jsx)(s.ck,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",a),...o})});m.displayName=s.ck.displayName,n.forwardRef((e,t)=>{let{className:a,children:n,checked:o,...l}=e;return(0,r.jsxs)(s.oC,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:o,...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(s.wU,{children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})}),n]})}).displayName=s.oC.displayName,n.forwardRef((e,t)=>{let{className:a,children:n,...o}=e;return(0,r.jsxs)(s.Rk,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...o,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(s.wU,{children:(0,r.jsx)(l.Z,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=s.Rk.displayName,n.forwardRef((e,t)=>{let{className:a,inset:n,...o}=e;return(0,r.jsx)(s.__,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",a),...o})}).displayName=s.__.displayName;let h=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...n})});h.displayName=s.Z0.displayName},7461:function(e,t,a){a.d(t,{AuthProvider:function(){return l},a:function(){return d}});var r=a(7437),n=a(2265);let s="http://52.66.24.57:3000/api",o={async login(e,t){let a=await fetch("".concat(s,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!a.ok)throw Error((await a.json().catch(()=>({message:"Login failed"}))).message||"Login failed");return a.json()},async register(e,t,a){let r=await fetch("".concat(s,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,password:a})});if(!r.ok)throw Error((await r.json().catch(()=>({message:"Registration failed"}))).message||"Registration failed");return r.json()},async getCurrentUser(){let e=localStorage.getItem("token");if(!e)throw Error("No token found");let t=await fetch("".concat(s,"/auth/me"),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok){if(401===t.status)throw localStorage.removeItem("token"),Error("Token expired");throw Error("Failed to get current user")}return t.json()},async refreshToken(){let e=localStorage.getItem("token"),t=await fetch("".concat(s,"/auth/refresh"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("Failed to refresh token");return t.json()},async logout(){let e=localStorage.getItem("token");try{await fetch("".concat(s,"/auth/logout"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)}})}catch(e){console.warn("Logout API call failed:",e)}finally{localStorage.removeItem("token")}}},i=(0,n.createContext)(void 0);function l(e){let{children:t}=e,[a,s]=(0,n.useState)(null),[l,d]=(0,n.useState)(!0);(0,n.useEffect)(()=>{localStorage.getItem("token")?o.getCurrentUser().then(s).catch(()=>localStorage.removeItem("token")).finally(()=>d(!1)):d(!1)},[]);let c=async(e,t)=>{let{user:a,token:r}=await o.login(e,t);return localStorage.setItem("token",r),s(a),a},u=async(e,t,a)=>{let{user:r,token:n}=await o.register(e,t,a);localStorage.setItem("token",n),s(r)};return(0,r.jsx)(i.Provider,{value:{user:a,login:c,register:u,logout:()=>{localStorage.removeItem("token"),s(null)},loading:l},children:t})}function d(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5153:function(e,t,a){a.d(t,{pm:function(){return f}});var r=a(2265);let n=0,s=new Map,o=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?o(a):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=i(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,a=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function f(){let[e,t]=r.useState(d);return r.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},4508:function(e,t,a){a.d(t,{cn:function(){return s}});var r=a(1994),n=a(3335);function s(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.m6)((0,r.W)(t))}}}]);