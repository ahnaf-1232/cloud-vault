(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{431:function(e,t,s){Promise.resolve().then(s.bind(s,1890))},1890:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return v}});var a=s(7437),l=s(2265),r=s(5476),i=s(918),n=s(6070),o=s(2869),c=s(2759),d=s(2762),h=s(7461),u=s(4428),f=s(8113),m=s(7689);let x=(0,s(9205).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var p=s(7648);let g="http://52.66.24.57:3000/api",y=()=>{let e=localStorage.getItem("token");return{Authorization:"Bearer ".concat(e)}},j={async getStorageUsageForUser(){let e=await fetch("".concat(g,"/analytics/user/storage-usage"),{headers:y()});if(!e.ok)throw Error("Failed to fetch user storage usage");return e.json()},async getFileTypeAnalyticsForUser(){let e=await fetch("".concat(g,"/analytics/user/file-types"),{headers:y()});if(!e.ok)throw Error("Failed to fetch user file type analytics");return e.json()},async getUserActivityForUser(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"30d",t=await fetch("".concat(g,"/analytics/user/user-activity?timeRange=").concat(e),{headers:y()});if(!t.ok)throw Error("Failed to fetch user activity analytics");return t.json()}},w=e=>e<1024?"".concat(e," bytes"):e<1048576?"".concat((e/1024).toFixed(2)," KB"):e<1073741824?"".concat((e/1024/1024).toFixed(2)," MB"):e<1099511627776?"".concat((e/1024/1024/1024).toFixed(2)," GB"):"".concat((e/1024/1024/1024/1024).toFixed(2)," TB");function v(){let{user:e}=(0,h.a)(),[t,s]=(0,l.useState)(null),[g,y]=(0,l.useState)(null),[v,b]=(0,l.useState)(null),[N,F]=(0,l.useState)([]),[k,S]=(0,l.useState)(!1),U=e=>(e/1073741824).toFixed(2);return(0,l.useEffect)(()=>{(async()=>{try{S(!0);let[e,t,a]=await Promise.all([j.getStorageUsageForUser(),j.getFileTypeAnalyticsForUser(),j.getUserActivityForUser()]),l=new Date;l.setDate(l.getDate()-7);let r=a.activities.filter(e=>new Date(e.timestamp)>=l);s(e),y(t),b(a),F(r)}catch(e){console.error("Error loading analytics data:",e)}finally{S(!1)}})()},[]),(0,a.jsx)(r.i,{children:(0,a.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,a.jsx)(i.w,{}),(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold",children:["Welcome back, ",null==e?void 0:e.name,"!"]}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Here's an overview of your storage"})]}),(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-8",children:[(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Storage Used"}),(0,a.jsx)(u.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[t?U(t.storageUsed):0," GB"]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["of ",t?U(t.storageLimit):0," GB total"]}),(0,a.jsx)(c.E,{value:t?t.storageUsed/t.storageLimit*100:0,className:"mt-2"})]})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Total Files"}),(0,a.jsx)(f.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:g?g.fileTypes.length:0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"+3 from last week"})]})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Recent Uploads"}),(0,a.jsx)(m.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:N.length}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"in the last 7 days"})]})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Last Activity"}),(0,a.jsx)(x,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:v&&v.activities.length>0?new Date(v.activities[0].timestamp).toLocaleString():"No activity"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"last activity timestamp"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{children:[(0,a.jsx)(n.ll,{children:"Quick Upload"}),(0,a.jsx)(n.SZ,{children:"Drag and drop files or click to browse"})]}),(0,a.jsx)(n.aY,{children:(0,a.jsx)(d.p,{})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(n.ll,{children:"Recent Files"}),(0,a.jsx)(n.SZ,{children:"Your latest uploads"})]}),(0,a.jsx)(o.z,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsx)(p.default,{href:"/files",children:"View All"})})]}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:N.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.fileName}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:w(e.fileSize)})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(e.timestamp).toLocaleString()})]},e._id))})})]})]})]})]})})}},2762:function(e,t,s){"use strict";s.d(t,{p:function(){return f}});var a=s(7437),l=s(2265),r=s(5598),i=s(2869),n=s(2759),o=s(7689),c=s(9658),d=s(2489),h=s(5153),u=s(9737);function f(){let{onUploadComplete:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,s]=(0,l.useState)([]),[f,m]=(0,l.useState)(!1),[x,p]=(0,l.useState)(0),{toast:g}=(0,h.pm)(),y=(0,l.useCallback)(e=>{s(e.map(e=>Object.assign(e,{preview:URL.createObjectURL(e)})))},[]),{getRootProps:j,getInputProps:w,isDragActive:v}=(0,r.uI)({onDrop:y,multiple:!0}),b=e=>{s(t.filter(t=>t!==e)),e.preview&&URL.revokeObjectURL(e.preview)},N=async()=>{if(0!==t.length){m(!0),p(0);try{for(let e=0;e<t.length;e++)await u.b.uploadFile(t[e]),p((e+1)/t.length*100);g({title:"Upload Successful",description:"".concat(t.length," file(s) uploaded successfully.")}),e&&e(),t.forEach(e=>{e.preview&&URL.revokeObjectURL(e.preview)}),s([])}catch(e){g({title:"Upload Failed",description:"Failed to upload files. Please try again.",variant:"destructive"})}finally{m(!1),p(0)}}},F=e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return Number.parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{...j(),className:"border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors ".concat(v?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary/50"),children:[(0,a.jsx)("input",{...w()}),(0,a.jsx)(o.Z,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),v?(0,a.jsx)("p",{children:"Drop the files here..."}):(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-lg font-medium",children:"Drag & drop files here"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"or click to browse"})]})]}),t.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Selected Files:"}),t.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 border rounded",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm",children:e.name}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",F(e.size),")"]})]}),(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>b(e),disabled:f,children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})})]},t))]}),f&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{children:"Uploading..."}),(0,a.jsxs)("span",{children:[Math.round(x),"%"]})]}),(0,a.jsx)(n.E,{value:x})]}),t.length>0&&(0,a.jsx)(i.z,{onClick:N,disabled:f,className:"w-full",children:f?"Uploading...":"Upload ".concat(t.length," file(s)")})]})}},2759:function(e,t,s){"use strict";s.d(t,{E:function(){return n}});var a=s(7437),l=s(2265),r=s(610),i=s(4508);let n=l.forwardRef((e,t)=>{let{className:s,value:l,...n}=e;return(0,a.jsx)(r.fC,{ref:t,className:(0,i.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...n,children:(0,a.jsx)(r.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(l||0),"%)")}})})});n.displayName=r.fC.displayName},9658:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]])},8113:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("Files",[["path",{d:"M20 7h-3a2 2 0 0 1-2-2V2",key:"x099mo"}],["path",{d:"M9 18a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h7l4 4v10a2 2 0 0 1-2 2Z",key:"18t6ie"}],["path",{d:"M3 7.6v12.8A1.6 1.6 0 0 0 4.6 22h9.8",key:"1nja0z"}]])},4428:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]])},2489:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9737:function(e,t,s){"use strict";s.d(t,{b:function(){return r}});let a="http://52.66.24.57:3000/api",l=()=>{let e=localStorage.getItem("token");return{Authorization:"Bearer ".concat(e)}},r={async uploadFile(e){let t=new FormData;t.append("file",e);let s=await fetch("".concat(a,"/files/upload"),{method:"POST",headers:l(),body:t});if(console.log(s.status),!s.ok)throw Error((await s.json().catch(()=>({message:"File upload failed"}))).message||"File upload failed");return s.json()},async getFiles(e,t){let s=new URLSearchParams;e&&s.append("query",e),(null==t?void 0:t.sortBy)&&s.append("sortBy",t.sortBy),(null==t?void 0:t.sortOrder)&&s.append("sortOrder",t.sortOrder),(null==t?void 0:t.fileTypes)&&t.fileTypes.length>0&&s.append("fileTypes",t.fileTypes.join(",")),(null==t?void 0:t.dateRange)&&s.append("dateRange",t.dateRange),(null==t?void 0:t.sizeRange)&&s.append("sizeRange",t.sizeRange),(null==t?void 0:t.page)&&s.append("page",t.page.toString()),(null==t?void 0:t.limit)&&s.append("limit",t.limit.toString());let r=await fetch("".concat(a,"/files?").concat(s),{headers:l()});if(!r.ok)throw Error("Failed to fetch files");return r.json()},async getFile(e){let t=await fetch("".concat(a,"/files/").concat(e),{headers:l()});if(!t.ok){if(404===t.status)throw Error("File not found");throw Error("Failed to fetch file")}return t.json()},async deleteFile(e){let t=await fetch("".concat(a,"/files/").concat(e),{method:"DELETE",headers:l()});if(!t.ok)throw Error((await t.json().catch(()=>({message:"Failed to delete file"}))).message||"Failed to delete file");return t.json()},async downloadFile(e){let t=await fetch("".concat(a,"/files/").concat(e,"/download"),{headers:l()});if(!t.ok)throw Error("Failed to download file");return t.blob()},async updateFile(e,t){let s=await fetch("".concat(a,"/files/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json",...l()},body:JSON.stringify(t)});if(!s.ok)throw Error("Failed to update file");return s.json()},async shareFile(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=await fetch("".concat(a,"/files/").concat(e,"/share"),{method:"POST",headers:{"Content-Type":"application/json",...l()},body:JSON.stringify(t)});if(!s.ok)throw Error("Failed to share file");return s.json()},async searchFiles(e){let t=new URLSearchParams;e.query&&t.append("q",e.query),e.fileTypes&&e.fileTypes.length>0&&t.append("fileTypes",e.fileTypes.join(",")),e.dateRange&&t.append("dateRange",e.dateRange),e.sizeRange&&t.append("sizeRange",e.sizeRange),e.sortBy&&t.append("sortBy",e.sortBy),e.sortOrder&&t.append("sortOrder",e.sortOrder),e.page&&t.append("page",e.page.toString()),e.limit&&t.append("limit",e.limit.toString());let s=await fetch("".concat(a,"/files/search/user?").concat(t),{headers:l()});if(!s.ok)throw Error("Failed to search files");return s.json()},async getFilterOptions(){let e=await fetch("".concat(a,"/files/filters"),{headers:l()});if(!e.ok)throw Error("Failed to fetch filter options");return e.json()}}}},function(e){e.O(0,[972,253,722,365,269,208,971,117,744],function(){return e(e.s=431)}),_N_E=e.O()}]);